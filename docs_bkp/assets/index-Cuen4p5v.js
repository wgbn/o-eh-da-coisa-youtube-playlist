(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const d of c.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function o(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(n){if(n.ep)return;n.ep=!0;const c=o(n);fetch(n.href,c)}})();const p="PL5DFl3pSRD__6vNCPZXtStCzWsNpy15sW",m="AIzaSyAz83_h8uIcKDQ0Nn2EujLs77-uYWM-G4A",u="watchedVideos";async function y(){try{let e=[],t="";do{const o=await fetch(`https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&maxResults=500&playlistId=${p}&key=${m}&pageToken=${t}`);if(!o.ok){const n=await o.json();throw new Error(n.error.message||"Erro ao acessar a API do YouTube")}const i=await o.json();e=[...e,...i.items],t=i.nextPageToken}while(t);return e.filter(o=>o.snippet&&o.snippet.thumbnails&&o.snippet.thumbnails.medium).map(o=>({id:o.snippet.resourceId.videoId,title:o.snippet.title,thumbnail:o.snippet.thumbnails.medium.url,publishedAt:new Date(o.snippet.publishedAt)})).sort((o,i)=>o.publishedAt-i.publishedAt)}catch(e){throw new Error(`Erro na API do YouTube: ${e.message}`)}}function f(){return new Set(JSON.parse(localStorage.getItem(u)||"[]"))}function g(e){localStorage.setItem(u,JSON.stringify([...e]))}let a=null;function w(){try{a=new YT.Player("player",{height:"360",width:"640",playerVars:{playsinline:1,autoplay:1,enablejsapi:1},events:{onStateChange:b}})}catch(e){console.log("# ERR Player",e.message)}}function l(e){document.getElementById("playerContainer").classList.remove("hidden"),console.log("# player",a),a&&a.loadVideoById?a.loadVideoById(e):setTimeout(()=>l(e),1e3)}function b(e){if(e.data===0){const t=a.getVideoData().video_id,o=document.querySelector(`[data-video-id="${t}"]`);o&&!o.checked&&o.click(),v(t)}}function v(e){const t=Array.from(document.querySelectorAll(".video-item")).map(n=>({id:n.querySelector(".watch-checkbox").dataset.videoId,watched:n.querySelector(".watch-checkbox").checked})),o=t.findIndex(n=>n.id===e),i=t.slice(o+1).find(n=>!n.watched);i&&l(i.id)}const s=f();let r=!1,h=[];function E(e){const t=document.createElement("div");t.className=`video-item ${s.has(e.id)?"watched":""}`,t.innerHTML=`
        <img src="${e.thumbnail}" alt="${e.title}" class="video-thumbnail">
        <div class="video-info">
            <div class="video-title">${e.title}</div>
            <div class="video-date">${e.publishedAt.toLocaleDateString()}</div>
        </div>
        <input type="checkbox" class="watch-checkbox" 
               data-video-id="${e.id}"
               ${s.has(e.id)?"checked":""}>
    `;const o=t.querySelector(".watch-checkbox");return o.addEventListener("change",()=>{o.checked?(s.add(e.id),t.classList.add("watched")):(s.delete(e.id),t.classList.remove("watched")),g(s)}),t.querySelector(".video-thumbnail").addEventListener("click",()=>{l(e.id)}),t}function I(e){h=e,document.getElementById("markAllWatched").addEventListener("click",k),document.getElementById("playFirst").addEventListener("click",A)}function k(){document.querySelectorAll(".watch-checkbox:not(:checked)").forEach(t=>{t.click()})}function A(){const e=h.find(t=>!s.has(t.id));e?l(e.id):alert("Todos os vídeos já foram assistidos!")}function S(){r=!r;const e=document.getElementById("toggleWatched");e.textContent=r?"Ocultar Assistidos":"Mostrar Assistidos",document.querySelectorAll(".video-item.watched").forEach(t=>{t.style.display=r?"flex":"none"})}function L(e){const t=document.createElement("div");t.className="error-message",t.textContent=e,document.querySelector(".container").appendChild(t)}async function x(){const e=document.getElementById("loading");e.style.display="block";try{setTimeout(()=>w(),3e3);const t=await y(),o=document.getElementById("videoList");t.forEach(i=>{o.appendChild(E(i))}),I(t),document.getElementById("toggleWatched").addEventListener("click",S)}catch(t){L(t.message)}finally{e.style.display="none"}}x();
